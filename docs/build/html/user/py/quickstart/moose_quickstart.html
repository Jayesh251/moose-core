<!DOCTYPE html>
<html class="writer-html5" lang="English" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Getting started with python scripting for MOOSE &mdash; MOOSE Jhangri (4.1.0 rc) documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/sphinx_highlight.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Demonstration of basic functionalities" href="demos.html" />
    <link rel="prev" title="MOOSE GUI: Graphical interface for MOOSE" href="qs_GUI.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> MOOSE
            <img src="../../../_static/moose_logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                4.1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../beginner.html">Beginner Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../intermediate.html">Intermediate Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../advanced.html">Advanced Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../introduction/index_introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../install/index_install.html">Installation</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index_qs.html">Quick Start</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="qs_inter.html">Interactive Tutorials</a></li>
<li class="toctree-l3"><a class="reference internal" href="qs_GUI.html">MOOSE GUI: Graphical interface for MOOSE</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Getting started with python scripting for MOOSE</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#coding-basics-and-how-to-use-this-document">Coding basics and how to use this document</a></li>
<li class="toctree-l4"><a class="reference internal" href="#importing-moose-and-accessing-documentation">Importing moose and accessing documentation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#setting-the-properties-of-elements-accessing-fields">Setting the properties of elements: accessing fields</a></li>
<li class="toctree-l4"><a class="reference internal" href="#putting-them-together-setting-up-connections">Putting them together: setting up connections</a></li>
<li class="toctree-l4"><a class="reference internal" href="#scheduling">Scheduling</a></li>
<li class="toctree-l4"><a class="reference internal" href="#running-the-simulation">Running the simulation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#some-more-details">Some more details</a></li>
<li class="toctree-l4"><a class="reference internal" href="#moving-on">Moving on</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="demos.html">Demonstration of basic functionalities</a></li>
<li class="toctree-l3"><a class="reference internal" href="classes_demos.html">MOOSE Classes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../references/index_ref.html">References</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../doxygen/doxy.html">Doxygen</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">MOOSE</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../../advanced.html">Advanced Guide</a> &raquo;</li>
          <li><a href="index_qs.html">Quick Start</a> &raquo;</li>
      <li>Getting started with python scripting for MOOSE</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/user/py/quickstart/moose_quickstart.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="getting-started-with-python-scripting-for-moose">
<h1>Getting started with python scripting for MOOSE<a class="headerlink" href="#getting-started-with-python-scripting-for-moose" title="Permalink to this heading">¶</a></h1>
<figure class="align-default" id="id9">
<a class="reference internal image-reference" href="../../../_images/Gallery_Moose_Multiscale.png"><img alt="**multiple scales in moose**" src="../../../_images/Gallery_Moose_Multiscale.png" style="width: 833.0px; height: 540.0px;" /></a>
<figcaption>
<p><span class="caption-text"><em>Multiple scales can be modelled and simulated in MOOSE</em></span><a class="headerlink" href="#id9" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p><em>To see an interactive version of this page, click the following link</em></p>
<a class="reference external image-reference" href="https://mybinder.org/v2/gh/BhallaLab/moose-binder/master?filepath=home%2Fmooser%2Fquickstart%2FGetting%20started%20with%20python%20scripting%20for%20MOOSE.ipynb"><img alt="https://mybinder.org/badge.svg" src="https://mybinder.org/badge.svg" /></a>
<p>This document describes how to use the <code class="docutils literal notranslate"><span class="pre">moose</span></code> module in Python
scripts or in an interactive Python shell. It aims to give you enough
overview to help you start scripting using MOOSE and extract farther
information that may be required for advanced work. Knowledge of
Python or programming in general will be helpful. If you just want to
simulate existing models in one of the supported formats, you can fire
the MOOSE GUI and locate the model file using the <code class="docutils literal notranslate"><span class="pre">File</span></code> menu and
load it. The GUI is described in separate document. If you
are looking for recipes for specific tasks, take a look at
<cite>cookbook</cite>. The example code in the boxes can be entered in
a Python shell.</p>
<p>MOOSE is object-oriented. Biological concepts are mapped into classes, and a model is built by creating instances of these classes and connecting them by messages. MOOSE also has numerical classes whose job is to take over difficult computations in a certain domain, and do them fast. There are such solver classes for stochastic and deterministic chemistry, for diffusion, and for multicompartment neuronal models.</p>
<p>MOOSE is a simulation environment, not just a numerical engine: It provides data representations and solvers (of course!), but also a scripting interface with Python, graphical displays with Matplotlib, PyQt, and OpenGL, and support for many model formats. These include SBML, NeuroML, GENESIS kkit and cell.p formats, HDF5 and NSDF for data writing.</p>
<p>Contents:</p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#coding-basics-and-how-to-use-this-document" id="id11">Coding basics and how to use this document</a></p></li>
<li><p><a class="reference internal" href="#importing-moose-and-accessing-documentation" id="id12">Importing moose and accessing documentation</a></p></li>
<li><p><a class="reference internal" href="#setting-the-properties-of-elements-accessing-fields" id="id13">Setting the properties of elements: accessing fields</a></p></li>
<li><p><a class="reference internal" href="#putting-them-together-setting-up-connections" id="id14">Putting them together: setting up connections</a></p></li>
<li><p><a class="reference internal" href="#scheduling" id="id15">Scheduling</a></p></li>
<li><p><a class="reference internal" href="#running-the-simulation" id="id16">Running the simulation</a></p></li>
<li><p><a class="reference internal" href="#some-more-details" id="id17">Some more details</a></p></li>
<li><p><a class="reference internal" href="#moving-on" id="id18">Moving on</a></p></li>
</ul>
</div>
<section id="coding-basics-and-how-to-use-this-document">
<h2><a class="toc-backref" href="#id11">Coding basics and how to use this document</a><a class="headerlink" href="#coding-basics-and-how-to-use-this-document" title="Permalink to this heading">¶</a></h2>
<p>This page acts as the first stepping stone for learning how moose works. The tutorials here are intended to be interactive, and are presented as python commands. Python commands are identifiable by the <code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;</span></code> before the command as opposed to <code class="docutils literal notranslate"><span class="pre">$</span></code> which identifies a command-line command.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">this_is_a_python_command</span>
</pre></div>
</div>
<p>You are encouraged to run a python shell while reading through this documentation and trying out each command for yourself. Python shells are environments within your terminal wherein everything you type is interpreted as a python command. They can be accessed by typing</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ python
</pre></div>
</div>
<p>in your command-line terminal.</p>
<p>While individually typing lines of code in a python terminal is useful for practicing using moose and coding in general, note that once you close the python environment all the code you typed is gone and the moose models created are also lost. In order to 'save' models that you create, you would have to type your code in a text file with a <code class="docutils literal notranslate"><span class="pre">.py</span></code> extension. The easiest way to do this is to create a text file in command line, open it with a text editor (for example, gedit), and simply type your code in (make sure you indent correctly).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ touch code.py
$ gedit code.py
</pre></div>
</div>
<p>Once you have written your code in the file, you can run it through your python environment.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ python code.py
</pre></div>
</div>
<p>Note that apart from this section of the quickstart, most of the moose documentation is in the form of <code class="docutils literal notranslate"><span class="pre">snippets</span></code>. These are basically <code class="docutils literal notranslate"><span class="pre">.py</span></code> files with code that demonstrates a certain functionality in moose. If you see a dialogue box like this one:</p>
<p>You can view the code by clicking the green source button on the left side of the box. Alternatively, the source code for all of the examples in the documentation can be found in <code class="docutils literal notranslate"><span class="pre">moose/moose-examples/snippets</span></code>. Once you run each file in python, it is encouraged that you look through the code to understand how it works.</p>
<p>In the quickstart, most of the snippets demonstrate the functionality of specific classes. However, snippets in later sections such as the cookbook show how to do specific things in moose such as creating networks, chemical models, and synaptic channels.</p>
</section>
<section id="importing-moose-and-accessing-documentation">
<h2><a class="toc-backref" href="#id12">Importing moose and accessing documentation</a><a class="headerlink" href="#importing-moose-and-accessing-documentation" title="Permalink to this heading">¶</a></h2>
<p>In a python script you import modules to access the functionalities they provide. In order to use moose, you need to import it within a python environment or at the beginning of your python script.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">moose</span>
</pre></div>
</div>
<p>This make the <code class="docutils literal notranslate"><span class="pre">moose</span></code> module available for use in Python. You can use Python's built-in <code class="docutils literal notranslate"><span class="pre">help</span></code> function to read the top-level documentation for the moose module.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">help</span><span class="p">(</span><span class="n">moose</span><span class="p">)</span>
</pre></div>
</div>
<p>This will give you an overview of the module. Press <code class="docutils literal notranslate"><span class="pre">q</span></code> to exit the pager and get back to the interpreter. You can also access the documentation for individual classes and functions this way.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">help</span><span class="p">(</span><span class="n">moose</span><span class="o">.</span><span class="n">connect</span><span class="p">)</span>
</pre></div>
</div>
<p>To list the available functions and classes you can use <code class="docutils literal notranslate"><span class="pre">dir</span></code>
function <a class="footnote-reference brackets" href="#id5" id="id1">1</a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">dir</span><span class="p">(</span><span class="n">moose</span><span class="p">)</span>
</pre></div>
</div>
<p>MOOSE has built-in documentation in the C++-source-code independent of
Python. The <code class="docutils literal notranslate"><span class="pre">moose</span></code> module has a separate <code class="docutils literal notranslate"><span class="pre">doc</span></code> function to extract
this documentation.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">moose</span><span class="o">.</span><span class="n">doc</span><span class="p">(</span><span class="s1">&#39;moose.Compartment&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The class level documentation will show whatever the author/maintainer
of the class wrote for documentation followed by a list of various kinds
of fields and their data types. This can be very useful in an
interactive session.</p>
<p>Each field can have its own detailed documentation, too.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">moose</span><span class="o">.</span><span class="n">doc</span><span class="p">(</span><span class="s1">&#39;Compartment.Rm&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that you need to put the class-name followed by dot followed by
field-name within quotes. Otherwise, <code class="docutils literal notranslate"><span class="pre">moose.doc</span></code> will receive the
field value as parameter and get confused.</p>
<p>Alternatively, if you want to see a full list of classes, functions and their fields, you can browse through the following pages. This is especially helpful when going through snippets.</p>
<ul class="simple">
<li><p><a class="reference internal" href="../../../genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="../../../py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
</ul>
<section id="creating-objects-and-traversing-the-object-hierarchy">
<span id="quickstart-creating"></span><h3>Creating objects and traversing the object hierarchy<a class="headerlink" href="#creating-objects-and-traversing-the-object-hierarchy" title="Permalink to this heading">¶</a></h3>
<p>Different types of biological entities like neurons, enzymes, etc are
represented by classes and individual instances of those types are
objects of those classes. Objects are the building-blocks of models in
MOOSE. We call MOOSE objects <code class="docutils literal notranslate"><span class="pre">element</span></code> and use object and element
interchangeably in the context of MOOSE. Elements are conceptually laid
out in a tree-like hierarchical structure. If you are familiar with file
system hierarchies in common operating systems, this should be simple.</p>
<p>At the top of the object hierarchy sits the <code class="docutils literal notranslate"><span class="pre">Shell</span></code>, equivalent to the
root directory in UNIX-based systems and represented by the path <code class="docutils literal notranslate"><span class="pre">/</span></code>.
You can list the existing objects under <code class="docutils literal notranslate"><span class="pre">/</span></code> using the <code class="docutils literal notranslate"><span class="pre">le</span></code> function.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">moose</span><span class="o">.</span><span class="n">le</span><span class="p">()</span>
<span class="go">Elements under /</span>
<span class="go">/Msgs</span>
<span class="go">/clock</span>
<span class="go">/classes</span>
<span class="go">/postmaster</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Msgs</span></code>, <code class="docutils literal notranslate"><span class="pre">clock</span></code> and <code class="docutils literal notranslate"><span class="pre">classes</span></code> are predefined objects in MOOSE. And
each object can contain other objects inside them. You can see them by
passing the path of the parent object to <code class="docutils literal notranslate"><span class="pre">le</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">moose</span><span class="o">.</span><span class="n">le</span><span class="p">(</span><span class="s1">&#39;/Msgs&#39;</span><span class="p">)</span>
<span class="go">Elements under /Msgs[0]</span>
<span class="go">/Msgs[0]/singleMsg</span>
<span class="go">/Msgs[0]/oneToOneMsg</span>
<span class="go">/Msgs[0]/oneToAllMsg</span>
<span class="go">/Msgs[0]/diagonalMsg</span>
<span class="go">/Msgs[0]/sparseMsg</span>
</pre></div>
</div>
<p>Now let us create some objects of our own. This can be done by invoking
MOOSE class constructors (just like regular Python classes).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">moose</span><span class="o">.</span><span class="n">Neutral</span><span class="p">(</span><span class="s1">&#39;/model&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The above creates a <code class="docutils literal notranslate"><span class="pre">Neutral</span></code> object named <code class="docutils literal notranslate"><span class="pre">model</span></code>. <code class="docutils literal notranslate"><span class="pre">Neutral</span></code> is
the most basic class in MOOSE. A <code class="docutils literal notranslate"><span class="pre">Neutral</span></code> element can act as a
container for other elements. We can create something under <code class="docutils literal notranslate"><span class="pre">model</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">soma</span> <span class="o">=</span> <span class="n">moose</span><span class="o">.</span><span class="n">Compartment</span><span class="p">(</span><span class="s1">&#39;/model/soma&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Every element has a unique path. This is a concatenation of the names of
all the objects one has to traverse starting with the root to reach that
element.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">soma</span><span class="o">.</span><span class="n">path</span>
<span class="go">/model/soma</span>
</pre></div>
</div>
<p>The name of the element can be printed, too.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">soma</span><span class="o">.</span><span class="n">name</span>
<span class="go">soma</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">Compartment</span></code> elements model small sections of a neuron. Some
basic experiments can be carried out using a single compartment. Let us
create another object to act on the <code class="docutils literal notranslate"><span class="pre">soma</span></code>. This will be a step
current generator to inject a current pulse into the soma.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pulse</span> <span class="o">=</span> <span class="n">moose</span><span class="o">.</span><span class="n">PulseGen</span><span class="p">(</span><span class="s1">&#39;/model/pulse&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>You can use <code class="docutils literal notranslate"><span class="pre">le</span></code> at any point to see what is there</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">moose</span><span class="o">.</span><span class="n">le</span><span class="p">(</span><span class="s1">&#39;/model&#39;</span><span class="p">)</span>
<span class="go">Elements under /model</span>
<span class="go">/model/soma</span>
<span class="go">/model/pulse</span>
</pre></div>
</div>
<p>And finally, we can create a <code class="docutils literal notranslate"><span class="pre">Table</span></code> to record the time series of the
soma's membrane potential. It is good practice to organize the data
separately from the model. So we do it as below</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">moose</span><span class="o">.</span><span class="n">Neutral</span><span class="p">(</span><span class="s1">&#39;/data&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vmtab</span> <span class="o">=</span> <span class="n">moose</span><span class="o">.</span><span class="n">Table</span><span class="p">(</span><span class="s1">&#39;/data/soma_Vm&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Now that we have the essential elements for a small model, we can go on
to set the properties of this model and the experimental protocol.</p>
</section>
</section>
<section id="setting-the-properties-of-elements-accessing-fields">
<span id="quickstart-properties"></span><h2><a class="toc-backref" href="#id13">Setting the properties of elements: accessing fields</a><a class="headerlink" href="#setting-the-properties-of-elements-accessing-fields" title="Permalink to this heading">¶</a></h2>
<p>Elements have several kinds of fields. The simplest ones are the
<code class="docutils literal notranslate"><span class="pre">value</span> <span class="pre">fields</span></code>. These can be accessed like ordinary Python members.
You can list the available value fields using <code class="docutils literal notranslate"><span class="pre">getFieldNames</span></code>
function</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">soma</span><span class="o">.</span><span class="n">getFieldNames</span><span class="p">(</span><span class="s1">&#39;valueFinfo&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Here <code class="docutils literal notranslate"><span class="pre">valueFinfo</span></code> is the type name for value fields. <code class="docutils literal notranslate"><span class="pre">Finfo</span></code> is
short form of <em>field information</em>. For each type of field there is a
name ending with <code class="docutils literal notranslate"><span class="pre">-Finfo</span></code>. The above will display the following
list</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="p">(</span><span class="s1">&#39;this&#39;</span><span class="p">,</span>
<span class="s1">&#39;name&#39;</span><span class="p">,</span>
<span class="s1">&#39;me&#39;</span><span class="p">,</span>
<span class="s1">&#39;parent&#39;</span><span class="p">,</span>
<span class="s1">&#39;children&#39;</span><span class="p">,</span>
<span class="s1">&#39;path&#39;</span><span class="p">,</span>
<span class="s1">&#39;class&#39;</span><span class="p">,</span>
<span class="s1">&#39;linearSize&#39;</span><span class="p">,</span>
<span class="s1">&#39;objectDimensions&#39;</span><span class="p">,</span>
<span class="s1">&#39;lastDimension&#39;</span><span class="p">,</span>
<span class="s1">&#39;localNumField&#39;</span><span class="p">,</span>
<span class="s1">&#39;pathIndices&#39;</span><span class="p">,</span>
<span class="s1">&#39;msgOut&#39;</span><span class="p">,</span>
<span class="s1">&#39;msgIn&#39;</span><span class="p">,</span>
<span class="s1">&#39;Vm&#39;</span><span class="p">,</span>
<span class="s1">&#39;Cm&#39;</span><span class="p">,</span>
<span class="s1">&#39;Em&#39;</span><span class="p">,</span>
<span class="s1">&#39;Im&#39;</span><span class="p">,</span>
<span class="s1">&#39;inject&#39;</span><span class="p">,</span>
<span class="s1">&#39;initVm&#39;</span><span class="p">,</span>
<span class="s1">&#39;Rm&#39;</span><span class="p">,</span>
<span class="s1">&#39;Ra&#39;</span><span class="p">,</span>
<span class="s1">&#39;diameter&#39;</span><span class="p">,</span>
<span class="s1">&#39;length&#39;</span><span class="p">,</span>
<span class="s1">&#39;x0&#39;</span><span class="p">,</span>
<span class="s1">&#39;y0&#39;</span><span class="p">,</span>
<span class="s1">&#39;z0&#39;</span><span class="p">,</span>
<span class="s1">&#39;x&#39;</span><span class="p">,</span>
<span class="s1">&#39;y&#39;</span><span class="p">,</span>
<span class="s1">&#39;z&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Some of these fields are for internal or advanced use, some give access
to the physical properties of the biological entity we are trying to
model. Now we are interested in <code class="docutils literal notranslate"><span class="pre">Cm</span></code>, <code class="docutils literal notranslate"><span class="pre">Rm</span></code>, <code class="docutils literal notranslate"><span class="pre">Em</span></code> and <code class="docutils literal notranslate"><span class="pre">initVm</span></code>.
In the most basic form, a neuronal compartment acts like a parallel
<code class="docutils literal notranslate"><span class="pre">RC</span></code> circuit with a battery attached. Here <code class="docutils literal notranslate"><span class="pre">R</span></code> and <code class="docutils literal notranslate"><span class="pre">C</span></code> are
resistor and capacitor connected in parallel, and the battery with
voltage <code class="docutils literal notranslate"><span class="pre">Em</span></code> is in series with the resistor, as shown below:</p>
<figure class="align-default" id="id10">
<img alt="**Passive neuronal compartment**" src="../../../_images/neuronalcompartment.jpg" />
<figcaption>
<p><span class="caption-text"><strong>Passive neuronal compartment</strong></span><a class="headerlink" href="#id10" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>The fields are populated with some defaults.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">soma</span><span class="o">.</span><span class="n">Cm</span><span class="p">,</span> <span class="n">soma</span><span class="o">.</span><span class="n">Rm</span><span class="p">,</span> <span class="n">soma</span><span class="o">.</span><span class="n">Vm</span><span class="p">,</span> <span class="n">soma</span><span class="o">.</span><span class="n">Em</span><span class="p">,</span> <span class="n">soma</span><span class="o">.</span><span class="n">initVm</span>
<span class="go">1.0 1.0 -0.06 -0.06 -0.06</span>
</pre></div>
</div>
<p>You can set the <code class="docutils literal notranslate"><span class="pre">Cm</span></code> and <code class="docutils literal notranslate"><span class="pre">Rm</span></code> fields to something realistic using
simple assignment (we follow SI unit) <a class="footnote-reference brackets" href="#id6" id="id2">2</a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">soma</span><span class="o">.</span><span class="n">Cm</span> <span class="o">=</span> <span class="mf">1e-9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">soma</span><span class="o">.</span><span class="n">Rm</span> <span class="o">=</span> <span class="mf">1e7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">soma</span><span class="o">.</span><span class="n">initVm</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.07</span>
</pre></div>
</div>
<p>Instead of writing print statements for each field, you could use the
utility function showfield to see that the changes took effect</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">moose</span><span class="o">.</span><span class="n">showfield</span><span class="p">(</span><span class="n">soma</span><span class="p">)</span>
<span class="go">[ /soma[0] ]</span>
<span class="go">diameter         = 0.0</span>
<span class="go">Ra               = 1.0</span>
<span class="go">y0               = 0.0</span>
<span class="go">Rm               = 10000000.0</span>
<span class="go">numData          = 1</span>
<span class="go">inject           = 0.0</span>
<span class="go">initVm           = -0.07</span>
<span class="go">Em               = -0.06</span>
<span class="go">y                = 0.0</span>
<span class="go">numField         = 1</span>
<span class="go">path             = /soma[0]</span>
<span class="go">dt               = 5e-05</span>
<span class="go">tick             = 4</span>
<span class="go">z0               = 0.0</span>
<span class="go">name             = soma</span>
<span class="go">Cm               = 1e-09</span>
<span class="go">x0               = 0.0</span>
<span class="go">Vm               = -0.06</span>
<span class="go">className        = Compartment</span>
<span class="go">length           = 0.0</span>
<span class="go">Im               = 0.0</span>
<span class="go">x                = 0.0</span>
<span class="go">z                = 0.0</span>
</pre></div>
</div>
<p>Now we can setup the current pulse to be delivered to the soma</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pulse</span><span class="o">.</span><span class="n">delay</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">50e-3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pulse</span><span class="o">.</span><span class="n">width</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">100e-3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pulse</span><span class="o">.</span><span class="n">level</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1e-9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pulse</span><span class="o">.</span><span class="n">delay</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1e9</span>
</pre></div>
</div>
<p>This tells the pulse generator to create a 100 ms long pulse 50 ms after
the start of the simulation. The amplitude of the pulse is set to 1 nA.
We set the delay for the next pulse to a very large value (larger than
the total simulation time) so that the stimulation stops after the first
pulse. Had we set <code class="docutils literal notranslate"><span class="pre">pulse.delay</span> <span class="pre">=</span> <span class="pre">0</span></code> , it would have generated a pulse
train at 50 ms intervals.</p>
</section>
<section id="putting-them-together-setting-up-connections">
<span id="quickstart-connections"></span><h2><a class="toc-backref" href="#id14">Putting them together: setting up connections</a><a class="headerlink" href="#putting-them-together-setting-up-connections" title="Permalink to this heading">¶</a></h2>
<p>In order for the elements to interact during simulation, we need to
connect them via messages. Elements are connected to each other using
special source and destination fields. These types are named
<code class="docutils literal notranslate"><span class="pre">srcFinfo</span></code> and <code class="docutils literal notranslate"><span class="pre">destFinfo</span></code>. You can query the available source and
destination fields on an element using <code class="docutils literal notranslate"><span class="pre">getFieldNames</span></code> as before. This
time, let us do it another way: by the class name</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">moose</span><span class="o">.</span><span class="n">getFieldNames</span><span class="p">(</span><span class="s1">&#39;PulseGen&#39;</span><span class="p">,</span> <span class="s1">&#39;srcFinfo&#39;</span><span class="p">)</span>
<span class="go">(&#39;childMsg&#39;, &#39;output&#39;)</span>
</pre></div>
</div>
<p>This form has the advantage that you can get information about a class
without creating elements of that class.</p>
<p>Here <code class="docutils literal notranslate"><span class="pre">childMsg</span></code> is a source field that is used by the MOOSE internals
to connect child elements to parent elements. The second one is of our
interest. Check out the built-in documentation here</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">moose</span><span class="o">.</span><span class="n">doc</span><span class="p">(</span><span class="s1">&#39;PulseGen.output&#39;</span><span class="p">)</span>
<span class="go">PulseGen.output: double - source field</span>
<span class="go">Current output level.</span>
</pre></div>
</div>
<p>so this is the output of the pulse generator and this must be injected
into the <code class="docutils literal notranslate"><span class="pre">soma</span></code> to stimulate it. But where in the <code class="docutils literal notranslate"><span class="pre">soma</span></code> can we send
it? Again, MOOSE has some introspection built in.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">soma</span><span class="o">.</span><span class="n">getFieldNames</span><span class="p">(</span><span class="s1">&#39;destFinfo&#39;</span><span class="p">)</span>
<span class="go">(&#39;parentMsg&#39;,</span>
<span class="go"> &#39;setThis&#39;,</span>
<span class="go"> &#39;getThis&#39;,</span>
<span class="go">   ...</span>
<span class="go"> &#39;setZ&#39;,</span>
<span class="go"> &#39;getZ&#39;,</span>
<span class="go"> &#39;injectMsg&#39;,</span>
<span class="go"> &#39;randInject&#39;,</span>
<span class="go"> &#39;cable&#39;,</span>
<span class="go"> &#39;process&#39;,</span>
<span class="go"> &#39;reinit&#39;,</span>
<span class="go"> &#39;initProc&#39;,</span>
<span class="go"> &#39;initReinit&#39;,</span>
<span class="go"> &#39;handleChannel&#39;,</span>
<span class="go"> &#39;handleRaxial&#39;,</span>
<span class="go"> &#39;handleAxial&#39;)</span>
</pre></div>
</div>
<p>Now that is a long list. But much of it are fields for internal or
special use. Anything that starts with <code class="docutils literal notranslate"><span class="pre">get</span></code> or <code class="docutils literal notranslate"><span class="pre">set</span></code> are internal
<code class="docutils literal notranslate"><span class="pre">destFinfo</span></code> used for accessing value fields (we shall use one of those
when setting up data recording). Among the rest <code class="docutils literal notranslate"><span class="pre">injectMsg</span></code> seems to
be the most likely candidate. Use the <code class="docutils literal notranslate"><span class="pre">connect</span></code> function to connect
the pulse generator output to the soma input</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">moose</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">pulse</span><span class="p">,</span> <span class="s1">&#39;output&#39;</span><span class="p">,</span> <span class="n">soma</span><span class="p">,</span> <span class="s1">&#39;injectMsg&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">connect(source,</span> <span class="pre">source_field,</span> <span class="pre">dest,</span> <span class="pre">dest_field)</span></code> creates a
<code class="docutils literal notranslate"><span class="pre">message</span></code> from <code class="docutils literal notranslate"><span class="pre">source</span></code> element's <code class="docutils literal notranslate"><span class="pre">source_field</span></code> field to <code class="docutils literal notranslate"><span class="pre">dest</span></code>
element's <code class="docutils literal notranslate"><span class="pre">dest_field</span></code> field and returns that message. Messages are
also elements. You can print them to see their identity</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">m</span>
<span class="go">&lt;moose.SingleMsg: id=5, dataId=733, path=/Msgs/singleMsg[733]&gt;</span>
</pre></div>
</div>
<p>You can print any element as above and the string representation will
show you the class, two numbers(<code class="docutils literal notranslate"><span class="pre">id</span></code> and <code class="docutils literal notranslate"><span class="pre">dataId</span></code>) uniquely
identifying it among all elements, and its path. You can get some more
information about a message</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">m</span><span class="o">.</span><span class="n">e1</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">e2</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">srcFieldsOnE1</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">destFieldsOnE2</span>
<span class="go">/model/pulse /model/soma (&#39;output&#39;,) (&#39;injectMsg&#39;,)</span>
</pre></div>
</div>
<p>will confirm what you already know.</p>
<p>A message element has fields <code class="docutils literal notranslate"><span class="pre">e1</span></code> and <code class="docutils literal notranslate"><span class="pre">e2</span></code> referring to the elements
it connects. For single one-directional messages these are source and
destination elements, which are <code class="docutils literal notranslate"><span class="pre">pulse</span></code> and <code class="docutils literal notranslate"><span class="pre">soma</span></code> respectively. The
next two items are lists of the field names which are connected by this
message.</p>
<p>You could also check which elements are connected to a particular field</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">soma</span><span class="o">.</span><span class="n">neighbors</span><span class="p">[</span><span class="s1">&#39;injectMsg&#39;</span><span class="p">]</span>
<span class="go">[&lt;moose.vec: class=PulseGen, id=729,path=/model/pulse&gt;]</span>
</pre></div>
</div>
<p>Notice that the list contains something called vec. We discuss this
<a class="reference external" href="#some-more-details">later</a>. Also <code class="docutils literal notranslate"><span class="pre">neighbors</span></code> is a new kind of
field: <code class="docutils literal notranslate"><span class="pre">lookupFinfo</span></code> which behaves like a dictionary. Next we connect
the table to the soma to retrieve its membrane potential <code class="docutils literal notranslate"><span class="pre">Vm</span></code>. This is
where all those <code class="docutils literal notranslate"><span class="pre">destFinfo</span></code> starting with <code class="docutils literal notranslate"><span class="pre">get</span></code> or <code class="docutils literal notranslate"><span class="pre">set</span></code> come in
use. For each value field <code class="docutils literal notranslate"><span class="pre">X</span></code>, there is a <code class="docutils literal notranslate"><span class="pre">destFinfo</span></code> <code class="docutils literal notranslate"><span class="pre">get{X}</span></code> to
retrieve the value at simulation time. This is used by the table to
record the values <code class="docutils literal notranslate"><span class="pre">Vm</span></code> takes.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">moose</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">vmtab</span><span class="p">,</span> <span class="s1">&#39;requestOut&#39;</span><span class="p">,</span> <span class="n">soma</span><span class="p">,</span> <span class="s1">&#39;getVm&#39;</span><span class="p">)</span>
<span class="go">&lt;moose.SingleMsg: id=5, dataIndex=0, path=/Msgs[0]/singleMsg[0]&gt;</span>
</pre></div>
</div>
<p>This finishes our model and recording setup. You might be wondering
about the source-destination relationship above. It is natural to think
that <code class="docutils literal notranslate"><span class="pre">soma</span></code> is the source of <code class="docutils literal notranslate"><span class="pre">Vm</span></code> values which should be sent to
<code class="docutils literal notranslate"><span class="pre">vmtab</span></code>. But here <code class="docutils literal notranslate"><span class="pre">requestOut</span></code> is a <code class="docutils literal notranslate"><span class="pre">srcFinfo</span></code> acting like a
reply card. This mode of obtaining data is called <em>pull</em> mode. <a class="footnote-reference brackets" href="#id7" id="id3">3</a></p>
<p>You can skip the next section on fine control of the timing of updates
and read <a class="reference internal" href="#quickstart-running"><span class="std std-ref">Running the simulation</span></a>.</p>
</section>
<section id="scheduling">
<span id="quickstart-scheduling"></span><h2><a class="toc-backref" href="#id15">Scheduling</a><a class="headerlink" href="#scheduling" title="Permalink to this heading">¶</a></h2>
<p>With the model all set up, we have to schedule the
simulation. Different components in a model may have different rates
of update. For example, the dynamics of electrical components require
the update intervals to be of the order 0.01 ms whereas chemical
components can be as slow as 1 s. Also, the results may depend on the
sequence of the updates of different components. These issues are
addressed in MOOSE using a clock-based update scheme. Each model
component is scheduled on a clock tick (think of multiple hands of a
clock ticking at different intervals and the object being updated at
each tick of the corresponding hand). The scheduling also guarantees
the correct sequencing of operations. For example, your Table objects
should always be scheduled <em>after</em> the computations that they are
recording, otherwise they will miss the outcome of the latest calculation.</p>
<p>MOOSE has a central clock element (<code class="docutils literal notranslate"><span class="pre">/clock</span></code>) to manage
time. Clock has a set of <code class="docutils literal notranslate"><span class="pre">Tick</span></code> elements under it that take care of
advancing the state of each element with time as the simulation
progresses. Every element to be included in a simulation must be
assigned a tick. Each tick can have a different ticking interval
(<code class="docutils literal notranslate"><span class="pre">dt</span></code>) that allows different elements to be updated at different
rates.</p>
<p>By default, every object is assigned a clock tick with reasonable default
timesteps as soon it is created:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Class</span> <span class="nb">type</span>                      <span class="n">tick</span>    <span class="n">dt</span>
<span class="n">Electrical</span> <span class="n">computations</span><span class="p">:</span>        <span class="mi">0</span><span class="o">-</span><span class="mi">7</span>     <span class="mi">50</span> <span class="n">microseconds</span>
<span class="n">electrical</span> <span class="n">compartments</span><span class="p">,</span>
<span class="n">V</span> <span class="ow">and</span> <span class="n">ligand</span><span class="o">-</span><span class="n">gated</span> <span class="n">ion</span> <span class="n">channels</span><span class="p">,</span>
<span class="n">Calcium</span> <span class="n">conc</span> <span class="ow">and</span> <span class="n">Nernst</span><span class="p">,</span>
<span class="n">stimulus</span> <span class="n">generators</span> <span class="ow">and</span> <span class="n">tables</span><span class="p">,</span>
<span class="n">HSolve</span><span class="o">.</span>

<span class="n">Table</span> <span class="p">(</span><span class="n">to</span> <span class="n">plot</span> <span class="n">elec</span><span class="o">.</span> <span class="n">signals</span><span class="p">)</span>   <span class="mi">8</span>       <span class="mi">100</span> <span class="n">microseconds</span>

<span class="n">Diffusion</span> <span class="n">solver</span>                <span class="mi">10</span>      <span class="mf">0.01</span> <span class="n">seconds</span>
<span class="n">Chemical</span> <span class="n">computations</span><span class="p">:</span>          <span class="mi">11</span><span class="o">-</span><span class="mi">17</span>   <span class="mf">0.1</span> <span class="n">seconds</span>
<span class="n">Pool</span><span class="p">,</span> <span class="n">Reac</span><span class="p">,</span> <span class="n">Enz</span><span class="p">,</span> <span class="n">MMEnz</span><span class="p">,</span>
<span class="n">Func</span><span class="p">,</span> <span class="n">Function</span><span class="p">,</span>
<span class="n">Gsolve</span><span class="p">,</span> <span class="n">Ksolve</span><span class="p">,</span>
<span class="n">Stats</span> <span class="p">(</span><span class="n">to</span> <span class="n">do</span> <span class="n">stats</span> <span class="n">on</span> <span class="n">outputs</span><span class="p">)</span>

<span class="n">Table2</span> <span class="p">(</span><span class="n">to</span> <span class="n">plot</span> <span class="n">chem</span><span class="o">.</span> <span class="n">signals</span><span class="p">)</span>  <span class="mi">18</span>      <span class="mi">1</span> <span class="n">second</span>

<span class="n">HDF5DataWriter</span>                  <span class="mi">30</span>      <span class="mi">1</span> <span class="n">second</span>
<span class="n">Postmaster</span> <span class="p">(</span><span class="k">for</span> <span class="n">parallel</span>        <span class="mi">31</span>      <span class="mf">0.01</span> <span class="n">seconds</span>
<span class="n">computations</span><span class="p">)</span>
</pre></div>
</div>
<p>There are 32 available clock ticks. Numbers 20 to 29 are
unassigned so you can use them for whatever purpose you like.</p>
<p>If you want fine control over the scheduling, there are three things
you can do.</p>
<blockquote>
<div><ul class="simple">
<li><p>Alter the 'tick' field on the object</p></li>
<li><p>Alter the dt associated with a given tick, using the
<strong>moose.setClock( tick, newdt)</strong> command</p></li>
<li><p>Go through a wildcard path of objects reassigning there clock ticks,
using <strong>moose.useClock( path, newtick, function)</strong>.</p></li>
</ul>
</div></blockquote>
<p>Here we discuss these in more detail.</p>
<p><strong>Altering the 'tick' field</strong></p>
<p>Every object knows which tick and dt it uses:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">moose</span><span class="o">.</span><span class="n">Pool</span><span class="p">(</span> <span class="s1">&#39;/a&#39;</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">a</span><span class="o">.</span><span class="n">tick</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">dt</span>
<span class="go">13 0.1</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">tick</span></code> field on every object can be changed, and the object will
adopt whatever clock dt is used for that tick. The <code class="docutils literal notranslate"><span class="pre">dt</span></code> field is
readonly, because changing it would have side-effects on every object
associated with the current tick.</p>
<p>Ticks <strong>-1</strong> and <strong>-2</strong> are special: They both tell the object that it is
disabled (not scheduled for any operations). An object with a
tick of <strong>-1</strong> will be left alone entirely. A tick of <strong>-2</strong> is used in
solvers to indicate that should the solver be removed, the object will
revert to its default tick.</p>
<p><strong>Altering the dt associated with a given tick</strong></p>
<p>We initialize the ticks and set their <code class="docutils literal notranslate"><span class="pre">dt</span></code> values using the
<code class="docutils literal notranslate"><span class="pre">setClock</span></code> function.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">moose</span><span class="o">.</span><span class="n">setClock</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.025e-3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">moose</span><span class="o">.</span><span class="n">setClock</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.025e-3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">moose</span><span class="o">.</span><span class="n">setClock</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.25e-3</span><span class="p">)</span>
</pre></div>
</div>
<p>This will initialize tick #0 and tick #1 with <code class="docutils literal notranslate"><span class="pre">dt</span> <span class="pre">=</span> <span class="pre">25</span></code> Î¼s and tick #2
with <code class="docutils literal notranslate"><span class="pre">dt</span> <span class="pre">=</span> <span class="pre">250</span></code> Î¼s. Thus all the elements scheduled on ticks #0 and 1
will be updated every 25 Î¼s and those on tick #2 every 250 Î¼s. We use
the faster clocks for the model components where finer timescale is
required for numerical accuracy and the slower clock to sample the
values of <code class="docutils literal notranslate"><span class="pre">Vm</span></code>.</p>
<p>Note that if you alter the dt associated with a given tick, this will
affect the update time for <em>all</em> the objects using that clock tick. If
you're unsure that you want to do this, use one of the vacant ticks.</p>
<p><strong>Assigning clock ticks to all objects in a wildcard path</strong></p>
<p>To assign tick #2 to the table for recording <code class="docutils literal notranslate"><span class="pre">Vm</span></code>, we pass its
whole path to the <code class="docutils literal notranslate"><span class="pre">useClock</span></code> function.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">moose</span><span class="o">.</span><span class="n">useClock</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;/data/soma_Vm&#39;</span><span class="p">,</span> <span class="s1">&#39;process&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Read this as &quot;use tick # 2 on the element at path <code class="docutils literal notranslate"><span class="pre">/data/soma_Vm</span></code> to
call its <code class="docutils literal notranslate"><span class="pre">process</span></code> method at every step&quot;. Every class that is supposed
to update its state or take some action during simulation implements a
<code class="docutils literal notranslate"><span class="pre">process</span></code> method. And in most cases that is the method we want the
ticks to call at every time step. A less common method is <code class="docutils literal notranslate"><span class="pre">init</span></code>,
which is implemented in some classes to interleave actions or updates
that must be executed in a specific order <a class="footnote-reference brackets" href="#id8" id="id4">4</a>. The <code class="docutils literal notranslate"><span class="pre">Compartment</span></code>
class is one such case where a neuronal compartment has to know the
<code class="docutils literal notranslate"><span class="pre">Vm</span></code> of its neighboring compartments before it can calculate its
<code class="docutils literal notranslate"><span class="pre">Vm</span></code> for the next step. This is done with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">moose</span><span class="o">.</span><span class="n">useClock</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">soma</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;init&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Here we used the <code class="docutils literal notranslate"><span class="pre">path</span></code> field instead of writing the path explicitly.</p>
<p>Next we assign tick #1 to process method of everything under <code class="docutils literal notranslate"><span class="pre">/model</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">moose</span><span class="o">.</span><span class="n">useClock</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;/model/##&#39;</span><span class="p">,</span> <span class="s1">&#39;process&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Here the second argument is an example of wild-card path. The <code class="docutils literal notranslate"><span class="pre">##</span></code>
matches everything under the path preceding it at any depth. Thus if we
had some other objects under <code class="docutils literal notranslate"><span class="pre">/model/soma</span></code>, <code class="docutils literal notranslate"><span class="pre">process</span></code> method of
those would also have been scheduled on tick #1. This is very useful for
complex models where it is tedious to scheduled each element
individually. In this case we could have used <code class="docutils literal notranslate"><span class="pre">/model/#</span></code> as well for
the path. This is a single level wild-card which matches only the
children of <code class="docutils literal notranslate"><span class="pre">/model</span></code> but does not go farther down in the hierarchy.</p>
</section>
<section id="running-the-simulation">
<span id="quickstart-running"></span><h2><a class="toc-backref" href="#id16">Running the simulation</a><a class="headerlink" href="#running-the-simulation" title="Permalink to this heading">¶</a></h2>
<p>Once the model is all set up, we can put the model to its
initial state using</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">moose</span><span class="o">.</span><span class="n">reinit</span><span class="p">()</span>
</pre></div>
</div>
<p>You may remember that we had changed initVm from <code class="docutils literal notranslate"><span class="pre">-0.06</span></code> to <code class="docutils literal notranslate"><span class="pre">-0.07</span></code>.
The reinit call we initialize <code class="docutils literal notranslate"><span class="pre">Vm</span></code> to that value. You can verify that</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">soma</span><span class="o">.</span><span class="n">Vm</span>
<span class="go">-0.07</span>
</pre></div>
</div>
<p>Finally, we run the simulation for 300 ms</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">moose</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="mf">300e-3</span><span class="p">)</span>
</pre></div>
</div>
<p>The data will be recorded by the <code class="docutils literal notranslate"><span class="pre">soma_vm</span></code> table, which is referenced
by the variable <code class="docutils literal notranslate"><span class="pre">vmtab</span></code>. The <code class="docutils literal notranslate"><span class="pre">Table</span></code> class provides a numpy array
interface to its content. The field is <code class="docutils literal notranslate"><span class="pre">vector</span></code>. So you can easily plot
the membrane potential using the <a class="reference external" href="http://matplotlib.org/">matplotlib</a>
library.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pylab</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">pylab</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">300e-3</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">vmtab</span><span class="o">.</span><span class="n">vector</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pylab</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">vmtab</span><span class="o">.</span><span class="n">vector</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pylab</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>The first line imports the pylab submodule from matplotlib. This useful
for interactive plotting. The second line creates the time points to
match our simulation time and length of the recorded data. The third
line plots the <code class="docutils literal notranslate"><span class="pre">Vm</span></code> and the fourth line makes it visible. Does the
plot match your expectation?</p>
</section>
<section id="some-more-details">
<span id="quickstart-details"></span><h2><a class="toc-backref" href="#id17">Some more details</a><a class="headerlink" href="#some-more-details" title="Permalink to this heading">¶</a></h2>
<section id="vec-melement-and-element">
<h3><code class="docutils literal notranslate"><span class="pre">vec</span></code>, <code class="docutils literal notranslate"><span class="pre">melement</span></code> and <code class="docutils literal notranslate"><span class="pre">element</span></code><a class="headerlink" href="#vec-melement-and-element" title="Permalink to this heading">¶</a></h3>
<p>MOOSE elements are instances of the class <code class="docutils literal notranslate"><span class="pre">melement</span></code>. <code class="docutils literal notranslate"><span class="pre">Compartment</span></code>,
<code class="docutils literal notranslate"><span class="pre">PulseGen</span></code> and other MOOSE classes are derived classes of
<code class="docutils literal notranslate"><span class="pre">melement</span></code>. All <code class="docutils literal notranslate"><span class="pre">melement</span></code> instances are contained in array-like
structures called <code class="docutils literal notranslate"><span class="pre">vec</span></code>. Each <code class="docutils literal notranslate"><span class="pre">vec</span></code> object has a numerical
<code class="docutils literal notranslate"><span class="pre">id_</span></code> field uniquely identifying it. An <code class="docutils literal notranslate"><span class="pre">vec</span></code> can have one or
more elements. You can create an array of elements</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">comp_array</span> <span class="o">=</span> <span class="n">moose</span><span class="o">.</span><span class="n">vec</span><span class="p">(</span><span class="s1">&#39;/model/comp&#39;</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;Compartment&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>This tells MOOSE to create an <code class="docutils literal notranslate"><span class="pre">vec</span></code> of 3 <code class="docutils literal notranslate"><span class="pre">Compartment</span></code> elements
with path <code class="docutils literal notranslate"><span class="pre">/model/comp</span></code>. For <code class="docutils literal notranslate"><span class="pre">vec</span></code> objects with multiple
elements, the index in the <code class="docutils literal notranslate"><span class="pre">vec</span></code> is part of the element path.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">comp_array</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">comp_array</span><span class="p">)</span>
</pre></div>
</div>
<p>shows that <code class="docutils literal notranslate"><span class="pre">comp_array</span></code> is an instance of <code class="docutils literal notranslate"><span class="pre">vec</span></code> class. You can
loop through the elements in an <code class="docutils literal notranslate"><span class="pre">vec</span></code> like a Python list</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">comp</span> <span class="ow">in</span> <span class="n">comp_array</span><span class="p">:</span>
<span class="gp">... </span>   <span class="nb">print</span> <span class="n">comp</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">comp</span><span class="p">)</span>
<span class="gp">...</span>
</pre></div>
</div>
<p>shows</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">model</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">comp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span><span class="nb">type</span> <span class="s1">&#39;moose.Compartment&#39;</span><span class="o">&gt;</span>
<span class="o">/</span><span class="n">model</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">comp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span><span class="nb">type</span> <span class="s1">&#39;moose.Compartment&#39;</span><span class="o">&gt;</span>
<span class="o">/</span><span class="n">model</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">comp</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;</span><span class="nb">type</span> <span class="s1">&#39;moose.Compartment&#39;</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Thus elements are instances of class <code class="docutils literal notranslate"><span class="pre">melement</span></code>. All elements in an
<code class="docutils literal notranslate"><span class="pre">vec</span></code> share the <code class="docutils literal notranslate"><span class="pre">id_</span></code> of the <code class="docutils literal notranslate"><span class="pre">vec</span></code> which can retrieved by
<code class="docutils literal notranslate"><span class="pre">melement.getId()</span></code>.</p>
<p>A frequent use case is that after loading a model from a file one knows
the paths of various model components but does not know the appropriate
class name for them. For this scenario there is a function called
<code class="docutils literal notranslate"><span class="pre">element</span></code> which converts (&quot;casts&quot; in programming jargon) a path or any
moose object to its proper MOOSE class. You can create additional
references to <code class="docutils literal notranslate"><span class="pre">soma</span></code> in the example this way</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">moose</span><span class="o">.</span><span class="n">element</span><span class="p">(</span><span class="s1">&#39;/model/soma&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Any MOOSE class can be extended in Python. But any additional attributes
added in Python are invisible to MOOSE. So those can be used for
functionalities at the Python level only. You can see
<code class="docutils literal notranslate"><span class="pre">moose-examples/squid/squid.py</span></code> for an example.</p>
</section>
<section id="finfos">
<h3><code class="docutils literal notranslate"><span class="pre">Finfos</span></code><a class="headerlink" href="#finfos" title="Permalink to this heading">¶</a></h3>
<p>The following kinds of <code class="docutils literal notranslate"><span class="pre">Finfo</span></code> are accessible in Python</p>
<ul class="simple">
<li><p><strong>``valueFinfo``</strong> : simple values. For each readable <code class="docutils literal notranslate"><span class="pre">valueFinfo</span></code>
<code class="docutils literal notranslate"><span class="pre">XYZ</span></code> there is a <code class="docutils literal notranslate"><span class="pre">destFinfo</span></code> <code class="docutils literal notranslate"><span class="pre">getXYZ</span></code> that can be used for
reading the value at run time. If <code class="docutils literal notranslate"><span class="pre">XYZ</span></code> is writable then there will
also be <code class="docutils literal notranslate"><span class="pre">destFinfo</span></code> to set it: <code class="docutils literal notranslate"><span class="pre">setXYZ</span></code>. Example:
<code class="docutils literal notranslate"><span class="pre">Compartment.Rm</span></code></p></li>
<li><p><strong>``lookupFinfo``</strong> : lookup tables. These fields act like Python
dictionaries but iteration is not supported. Example:
<code class="docutils literal notranslate"><span class="pre">Neutral.neighbors</span></code>.</p></li>
<li><p><strong>``srcFinfo``</strong> : source of a message. Example:
<code class="docutils literal notranslate"><span class="pre">PulseGen.output</span></code>.</p></li>
<li><p><strong>``destFinfo``</strong> : destination of a message. Example:
<code class="docutils literal notranslate"><span class="pre">Compartment.injectMsg</span></code>. Apart from being used in setting up
messages, these are accessible as functions from Python.
<code class="docutils literal notranslate"><span class="pre">HHGate.setupAlpha</span></code> is an example.</p></li>
<li><p><strong>``sharedFinfo``</strong> : a composition of source and destination fields.
Example: <code class="docutils literal notranslate"><span class="pre">Compartment.channel</span></code>.</p></li>
</ul>
</section>
</section>
<section id="moving-on">
<span id="quickstart-moving-on"></span><h2><a class="toc-backref" href="#id18">Moving on</a><a class="headerlink" href="#moving-on" title="Permalink to this heading">¶</a></h2>
<p>Now you know the basics of pymoose and how to access the help
system. You can figure out how to do specific things by looking at the
'cookbook`.  In addition, the <code class="docutils literal notranslate"><span class="pre">moose-examples/snippets</span></code> directory
in your MOOSE installation has small executable python scripts that
show usage of specific classes or functionalities. Beyond that you can
browse the code in the <code class="docutils literal notranslate"><span class="pre">moose-examples</span></code> directory to see some more complex
models.</p>
<p>MOOSE is backward compatible with GENESIS and most GENESIS classes have
been reimplemented in MOOSE. There is slight change in naming (MOOSE
uses CamelCase), and setting up messages are different. But <a class="reference external" href="http://www.genesis-sim.org/GENESIS/Hyperdoc/Manual.html">GENESIS
documentation</a>
is still a good source for documentation on classes that have been
ported from GENESIS.</p>
<p>If the built-in MOOSE classes do not satisfy your needs entirely, you
are welcome to add new classes to MOOSE. The API documentation will
help you get started.</p>
<dl class="footnote brackets">
<dt class="label" id="id5"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>To list the classes only, use <code class="docutils literal notranslate"><span class="pre">moose.le('/classes')</span></code></p>
</dd>
<dt class="label" id="id6"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p>MOOSE is unit agnostic and things should work fine as long as you use
values all converted to a consistent unit system.</p>
</dd>
<dt class="label" id="id7"><span class="brackets"><a class="fn-backref" href="#id3">3</a></span></dt>
<dd><p>This apparently convoluted implementation is for performance reason.
Can you figure out why? <em>Hint: the table is driven by a slower clock
than the compartment.</em></p>
</dd>
<dt class="label" id="id8"><span class="brackets"><a class="fn-backref" href="#id4">4</a></span></dt>
<dd><p>In principle any function available in a MOOSE class can be executed
periodically this way as long as that class exposes the function for
scheduling following the MOOSE API. So you have to consult the class'
documentation for any nonstandard methods that can be scheduled this
way.</p>
</dd>
</dl>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="qs_GUI.html" class="btn btn-neutral float-left" title="MOOSE GUI: Graphical interface for MOOSE" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="demos.html" class="btn btn-neutral float-right" title="Demonstration of basic functionalities" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Upinder Bhalla, Niraj Dudani, Subhasis Ray, Aditya Gilra,Harsha Rani, Aviral Goel, Dilawar Singh,Malav Shah, Dhruva Gowda Storz.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>